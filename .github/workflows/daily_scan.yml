name: Nano Stock Radar (çº³ç±³é›·è¾¾)

# è§¦å‘è§„åˆ™ï¼š
# 1. schedule: æ¯30åˆ†é’Ÿè‡ªåŠ¨è¿è¡Œ
# 2. workflow_dispatch: å…è®¸ä½ æ‰‹åŠ¨ç‚¹å‡»æŒ‰é’®è¿è¡Œ (æµ‹è¯•ç”¨)
on:
  schedule:
    # ğŸ‘‡ æ”¹äº†è¿™é‡Œï¼åªåœ¨ç¾è‚¡äº¤æ˜“æ—¶æ®µè¿è¡Œï¼Œæ‹’ç»åŠå¤œéªšæ‰°
    - cron: '*/30 13-21 * * 1-5'
  workflow_dispatch:

jobs:
  scan-job:
    runs-on: ubuntu-latest

    steps:
    # 1. æ‹‰å–ä½ çš„ä»£ç ä»“åº“
    - name: Checkout code
      uses: actions/checkout@v2

    # 2. å‡†å¤‡ Python ç¯å¢ƒ
    - name: Set up Python
      uses: actions/setup-python@v2
      with:
        python-version: '3.9'

    # 3. å®‰è£…ä¾èµ– (è¯»å–ä½ çš„ requirements.txt)
    - name: Install dependencies
      run: |
        pip install -r requirements.txt

    # 4. è¿è¡Œæ‰«æè„šæœ¬
    - name: Run Scanner Script
      env:
        # è¿™é‡ŒæŠŠä½ çš„ä¸‰ä¸ªé‚®ç®±å¯†ç ä¼ è¿›å»
        MAIL_USER: ${{ secrets.MAIL_USER }}
        MAIL_PASS: ${{ secrets.MAIL_PASS }}
        MAIL_TO: ${{ secrets.MAIL_TO }}
      run: python monitor.py
